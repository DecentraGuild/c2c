@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Theme variables are set by the theme store via JavaScript */
    /* Default fallback values (green primary, red secondary theme) */
    --theme-primary: #00951a;
    --theme-primary-hover: #00b820;
    --theme-primary-light: #00cc22;
    --theme-primary-dark: #007a14;
    
    --theme-secondary: #cf0000;
    --theme-secondary-hover: #b30000;
    --theme-secondary-light: #ff3333;
    --theme-secondary-dark: #990000;
    
    --theme-accent: #8b5cf6;
    --theme-accent-hover: #7c3aed;
    
    --theme-bg-primary: #0a0a0f;
    --theme-bg-secondary: #141420;
    --theme-bg-card: #1a1a2e;
    
    --theme-text-primary: #ffffff;
    --theme-text-secondary: #a0a0b3;
    --theme-text-muted: #6b6b80;
    
    --theme-border: #2a2a3e;
    --theme-border-light: #3a3a4e;
    
    --theme-success: #00951a;
    --theme-error: #cf0000;
    --theme-warning: #ff6b35;
    --theme-info: #00d4ff;
    
    --theme-trade-buy: #00ff00;
    --theme-trade-buy-hover: #00cc00;
    --theme-trade-buy-light: #33ff33;
    --theme-trade-sell: #ff0000;
    --theme-trade-sell-hover: #cc0000;
    --theme-trade-sell-light: #ff3333;
    --theme-trade-trade: #ffaa00;
    --theme-trade-trade-hover: #cc8800;
    --theme-trade-trade-light: #ffbb33;
    --theme-trade-swap: #6366f1;
    --theme-trade-swap-hover: #4f46e5;
    --theme-trade-swap-light: #818cf8;

    --theme-window-bg: #1a1a2e;
    --theme-window-border: #2a2a3e;
    --theme-window-header: #141420;
    
    --theme-font-xs: 0.75rem;
    --theme-font-sm: 0.875rem;
    --theme-font-base: 1rem;
    --theme-font-lg: 1.125rem;
    --theme-font-xl: 1.25rem;
    --theme-font-2xl: 1.5rem;
    --theme-font-3xl: 1.875rem;
    --theme-font-4xl: 2.25rem;
    --theme-font-5xl: 3rem;
    
    --theme-space-xs: 0.5rem;
    --theme-space-sm: 0.75rem;
    --theme-space-md: 1rem;
    --theme-space-lg: 1.5rem;
    --theme-space-xl: 2rem;
    --theme-space-2xl: 3rem;
    
    --theme-radius-sm: 0.5rem;
    --theme-radius-md: 0.75rem;
    --theme-radius-lg: 1rem;
    --theme-radius-xl: 1.25rem;
    --theme-radius-full: 9999px;
    
    --theme-border-thin: 1px;
    --theme-border-medium: 2px;
    --theme-border-thick: 4px;
    
    --theme-gradient-primary: linear-gradient(135deg, #00951a 0%, #00cc22 50%, #007a14 100%);
    --theme-gradient-secondary: linear-gradient(135deg, #ff6b35 0%, #f59e0b 100%);
    --theme-gradient-accent: linear-gradient(135deg, #00951a 0%, #cf0000 100%);
    
    --theme-shadow-glow: 0 0 20px rgba(0, 149, 26, 0.3);
    --theme-shadow-glow-hover: 0 0 40px rgba(0, 149, 26, 0.6);
    --theme-shadow-card: 0 8px 32px rgba(0, 0, 0, 0.4);
    
    /* Legacy variables for backward compatibility */
    --primary-bg: var(--theme-bg-primary);
    --secondary-bg: var(--theme-bg-secondary);
    --card-bg: var(--theme-bg-card);
    --primary-color: var(--theme-primary);
    --primary-hover: var(--theme-primary-hover);
    --accent-color: var(--theme-accent);
    --accent-secondary: var(--theme-warning);
    --text-primary: var(--theme-text-primary);
    --text-secondary: var(--theme-text-secondary);
    --text-muted: var(--theme-text-muted);
    --border-color: var(--theme-border);
  }

  body {
    @apply bg-primary-bg text-text-secondary font-primary;
    /* Support for mobile safe areas (notched devices) */
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
    /* Main frame scrollbar – same styled scrollbar as modals/dropdowns */
    scrollbar-width: thin;
    scrollbar-color: rgba(42, 42, 62, 0.5) transparent;
  }

  html::-webkit-scrollbar,
  body::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }
  html::-webkit-scrollbar-track,
  body::-webkit-scrollbar-track {
    background: transparent;
  }
  html::-webkit-scrollbar-thumb,
  body::-webkit-scrollbar-thumb {
    background: rgba(42, 42, 62, 0.5);
    border-radius: 3px;
  }
  html::-webkit-scrollbar-thumb:hover,
  body::-webkit-scrollbar-thumb:hover {
    background: rgba(42, 42, 62, 0.8);
  }
  @supports (background: var(--theme-border)) {
    html::-webkit-scrollbar-thumb,
    body::-webkit-scrollbar-thumb {
      background: var(--theme-border);
      opacity: 0.5;
    }
    html::-webkit-scrollbar-thumb:hover,
    body::-webkit-scrollbar-thumb:hover {
      background: var(--theme-border);
      opacity: 0.8;
    }
  }
  
  /* Support for dynamic viewport height (mobile keyboards) */
  @supports (-webkit-touch-callout: none) {
    /* iOS Safari */
    html, body {
      min-height: -webkit-fill-available;
    }
  }
  
  /* Android and other mobile browsers */
  @media (max-width: 640px) {
    html, body {
      min-height: 100vh;
      min-height: 100dvh; /* Dynamic viewport height - adjusts for keyboard */
    }
  }
}

@layer components {
  .btn-primary {
    background: var(--theme-gradient-primary);
    @apply text-text-primary font-semibold py-2 px-4 rounded-xl transition-all duration-300 text-sm;
    /* Ensure minimum touch target size for mobile */
    min-height: 44px;
  }
  
  .btn-primary:hover {
    box-shadow: var(--theme-shadow-glow);
  }
  
  .btn-primary:focus,
  .btn-primary:focus-visible {
    outline: 2px solid var(--theme-primary);
    outline-offset: 2px;
    box-shadow: var(--theme-shadow-glow), 0 0 0 2px var(--theme-primary);
  }
  
  .btn-secondary {
    @apply bg-card-bg text-text-primary border-2 border-border-color hover:border-primary-color font-semibold py-1.5 px-3 rounded-xl transition-all duration-300 text-sm;
    /* Ensure minimum touch target size for mobile */
    min-height: 44px;
    position: relative;
  }
  
  .btn-secondary:hover::before {
    content: '';
    position: absolute;
    inset: 0;
    background-color: var(--theme-primary);
    opacity: 0.1;
    border-radius: inherit;
    pointer-events: none;
    z-index: 0;
  }
  
  .btn-secondary:hover > * {
    position: relative;
    z-index: 1;
  }
  
  .btn-secondary:focus,
  .btn-secondary:focus-visible {
    outline: 2px solid var(--theme-primary);
    outline-offset: 2px;
    border-color: var(--theme-primary);
  }
  
  .btn-cancel {
    background-color: var(--theme-bg-card);
    border: 2px solid var(--theme-secondary);
    color: var(--theme-secondary);
    @apply font-semibold rounded-xl transition-all duration-300;
  }
  
  .btn-cancel:hover:not(:disabled) {
    background-color: var(--theme-secondary);
    color: var(--theme-text-primary);
    border-color: var(--theme-secondary);
  }
  
  .link-red {
    color: var(--theme-secondary);
  }
  
  .link-red:hover {
    color: var(--theme-secondary-hover);
  }
  
  /* Navbar link styles */
  .nav-link:focus,
  .nav-link:focus-visible {
    outline: 2px solid var(--theme-primary);
    outline-offset: 2px;
    border-radius: 0.5rem;
  }
  
  .input-field {
    @apply bg-card-bg border border-border-color rounded-xl px-3 py-2 text-sm text-text-primary placeholder-text-muted focus:outline-none focus:border-primary-color focus:ring-1 transition-all;
    /* Prevent iOS zoom on input focus - font size must be at least 16px */
    font-size: 16px;
  }
  
  .input-field:focus {
    box-shadow: 0 0 0 1px var(--theme-primary), 0 0 0 3px color-mix(in srgb, var(--theme-primary) 20%, transparent);
  }
  
  @supports not (color: color-mix(in srgb, var(--theme-primary) 20%, transparent)) {
    .input-field:focus {
      box-shadow: 0 0 0 1px var(--theme-primary), 0 0 0 3px rgba(0, 149, 26, 0.2);
    }
  }
  
  @media (min-width: 640px) {
    .input-field {
      font-size: 0.875rem; /* 14px on desktop */
    }
  }
  
  /* Hide spinner arrows on number inputs */
  .input-field[type="number"]::-webkit-inner-spin-button,
  .input-field[type="number"]::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  
  .input-field[type="number"] {
    -moz-appearance: textfield;
  }

  /* Vue DatePicker Custom Styling */
  .datetime-picker {
    @apply w-full;
  }

  .datetime-picker .dp__input_wrap input {
    @apply bg-card-bg border border-border-color rounded-xl px-3 py-2 text-sm text-text-primary placeholder-text-muted focus:outline-none focus:border-primary-color focus:ring-1 transition-all min-h-[44px];
    font-size: 16px;
  }
  
  .datetime-picker .dp__input_wrap input:focus {
    box-shadow: 0 0 0 1px var(--theme-primary), 0 0 0 3px color-mix(in srgb, var(--theme-primary) 20%, transparent);
  }
  
  @supports not (color: color-mix(in srgb, var(--theme-primary) 20%, transparent)) {
    .datetime-picker .dp__input_wrap input:focus {
      box-shadow: 0 0 0 1px var(--theme-primary), 0 0 0 3px rgba(0, 149, 26, 0.2);
    }
  }

  @media (min-width: 640px) {
    .datetime-picker .dp__input_wrap input {
      font-size: 0.875rem;
    }
  }

  .datetime-picker .dp__menu {
    @apply bg-card-bg border border-border-color rounded-xl shadow-xl;
  }

  .datetime-picker .dp__calendar_header_item {
    @apply text-text-primary;
  }

  .datetime-picker .dp__calendar_header_item:hover {
    @apply bg-secondary-bg;
  }

  .datetime-picker .dp__calendar_item {
    @apply text-text-secondary;
  }

  .datetime-picker .dp__calendar_item:hover {
    @apply bg-secondary-bg text-text-primary;
  }

  .datetime-picker .dp__calendar_item.dp__active_date {
    background: var(--theme-primary);
    @apply text-text-primary;
  }

  .datetime-picker .dp__calendar_item.dp__range_start,
  .datetime-picker .dp__calendar_item.dp__range_end {
    background: var(--theme-primary);
    @apply text-text-primary;
  }

  .datetime-picker .dp__calendar_item.dp__today {
    border-color: var(--theme-primary);
  }

  .datetime-picker .dp__time_input {
    @apply bg-card-bg border border-border-color text-text-primary;
  }

  .datetime-picker .dp__time_input:focus {
    border-color: var(--theme-primary);
    box-shadow: 0 0 0 1px var(--theme-primary), 0 0 0 3px color-mix(in srgb, var(--theme-primary) 20%, transparent);
  }
  
  @supports not (color: color-mix(in srgb, var(--theme-primary) 20%, transparent)) {
    .datetime-picker .dp__time_input:focus {
      box-shadow: 0 0 0 1px var(--theme-primary), 0 0 0 3px rgba(0, 149, 26, 0.2);
    }
  }

  .datetime-picker .dp__time_col_reg {
    @apply text-text-primary;
  }

  .datetime-picker .dp__arrow_top {
    @apply border-b-border-color;
  }

  .datetime-picker .dp__arrow_bottom {
    @apply border-t-border-color;
  }

  .datetime-picker .dp__inner_nav {
    @apply text-text-primary hover:bg-secondary-bg;
  }

  .datetime-picker .dp__month_year_select {
    @apply text-text-primary hover:bg-secondary-bg;
  }
  
  .card {
    @apply bg-card-bg border border-border-color p-3 shadow-card;
    border-radius: var(--theme-radius-lg, 1rem);
  }

  /* Shared collection scrollbar styles */
  .collection-scroll-container {
    direction: rtl;
    scrollbar-width: thin;
    scrollbar-color: rgba(42, 42, 62, 0.5) transparent;
  }
  
  .collection-scroll-content {
    direction: ltr;
  }
  
  /* Custom scrollbar styling for Webkit browsers */
  .collection-scroll-container::-webkit-scrollbar {
    width: 6px;
  }
  
  .collection-scroll-container::-webkit-scrollbar-track {
    background: transparent;
  }
  
  .collection-scroll-container::-webkit-scrollbar-thumb {
    background: rgba(42, 42, 62, 0.5);
    border-radius: 3px;
  }
  
  .collection-scroll-container::-webkit-scrollbar-thumb:hover {
    background: rgba(42, 42, 62, 0.8);
  }
  
  /* Use theme color if available, fallback to rgba */
  @supports (background: var(--theme-border)) {
    .collection-scroll-container::-webkit-scrollbar-thumb {
      background: var(--theme-border);
      opacity: 0.5;
    }
    
    .collection-scroll-container::-webkit-scrollbar-thumb:hover {
      background: var(--theme-border);
      opacity: 0.8;
    }
  }

  /* Base scroll area – reusable sliding/scroll bar (use in modals, dropdowns, lists) */
  .base-scroll-area {
    scrollbar-width: thin;
    scrollbar-color: rgba(42, 42, 62, 0.5) transparent;
  }
  .base-scroll-area::-webkit-scrollbar {
    width: 6px;
  }
  .base-scroll-area::-webkit-scrollbar-track {
    background: transparent;
  }
  .base-scroll-area::-webkit-scrollbar-thumb {
    background: rgba(42, 42, 62, 0.5);
    border-radius: 3px;
  }
  .base-scroll-area::-webkit-scrollbar-thumb:hover {
    background: rgba(42, 42, 62, 0.8);
  }
  @supports (background: var(--theme-border)) {
    .base-scroll-area::-webkit-scrollbar-thumb {
      background: var(--theme-border);
      opacity: 0.5;
    }
    .base-scroll-area::-webkit-scrollbar-thumb:hover {
      background: var(--theme-border);
      opacity: 0.8;
    }
  }
  
  .section-banner {
    background: var(--theme-gradient-primary);
    @apply text-text-primary font-semibold text-sm font-bold py-1.5 px-4 rounded-t-xl;
  }

  .text-gradient {
    background: var(--theme-gradient-primary);
    @apply bg-clip-text text-transparent;
  }
  
  /* Safe area utility classes for notched devices */
  .safe-area-top {
    padding-top: env(safe-area-inset-top);
  }
  
  .safe-area-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  .safe-area-left {
    padding-left: env(safe-area-inset-left);
  }
  
  .safe-area-right {
    padding-right: env(safe-area-inset-right);
  }
  
  /* Safe area for horizontal padding (landscape mode) */
  .safe-area-x {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
  
  /* Safe area for vertical padding */
  .safe-area-y {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  /* Container that respects safe areas */
  .safe-container {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
}

@layer utilities {
  /* Hide broken images completely - no ugly broken image icon */
  img[src]:not([src=""]) {
    @apply inline-block;
  }
  
  img:not([src]),
  img[src=""],
  img[src="null"],
  img[src="undefined"] {
    @apply hidden;
  }
  
}

/* Custom wallet button styling to match exchange button (btn-primary) - ONLY for navbar button */
.wallet-button-custom button,
.wallet-button-custom > button {
  background: var(--theme-gradient-primary);
  color: var(--theme-text-primary);
  border-radius: var(--theme-radius-md);
  font-weight: 600;
  padding: 0.5rem 0.75rem;
  transition: all 0.3s ease;
  border: none;
  font-size: 0.75rem;
  box-shadow: none;
  min-height: 36px;
  white-space: nowrap;
}

@media (min-width: 640px) {
  .wallet-button-custom button,
  .wallet-button-custom > button {
    padding: 0.5rem 1rem;
    font-size: 0.875rem;
    min-height: auto;
  }
}

.wallet-button-custom button:hover,
.wallet-button-custom > button:hover {
  background: var(--theme-gradient-primary);
  opacity: 0.9;
  box-shadow: var(--theme-shadow-glow);
  transform: none;
}

/* Compact navbar: square wallet button, icon only (no address text) */
.wallet-button-compact.wallet-button-custom button,
.wallet-button-compact.wallet-button-custom > button {
  min-width: 2.5rem;
  min-height: 2.5rem;
  width: 2.5rem;
  height: 2.5rem;
  padding: 0;
  border-radius: var(--theme-radius-md);
  font-size: 0;
  line-height: 0;
  overflow: hidden;
}
/* Hide address/text; keep only icon (SVG) visible */
.wallet-button-compact.wallet-button-custom button span,
.wallet-button-compact.wallet-button-custom > button span {
  display: none;
}
.wallet-button-compact.wallet-button-custom button svg,
.wallet-button-compact.wallet-button-custom > button svg {
  display: block;
  width: 1.25rem;
  height: 1.25rem;
  margin: 0 auto;
}
@media (min-width: 640px) {
  .wallet-button-compact.wallet-button-custom button,
  .wallet-button-compact.wallet-button-custom > button {
    min-width: 2.75rem;
    min-height: 2.75rem;
    width: 2.75rem;
    height: 2.75rem;
  }
  .wallet-button-compact.wallet-button-custom button svg,
  .wallet-button-compact.wallet-button-custom > button svg {
    width: 1.375rem;
    height: 1.375rem;
  }
}

/* Reset wallet modal individual wallet options to default styling */
/* Target all buttons inside the modal except the main connect button */
.swv-modal-wrapper button:not(.swv-button),
.swv-modal-wrapper [class*="wallet"]:not(.swv-button),
.swv-modal-list button,
.swv-modal-list-item button,
.swv-modal-list-item,
[class*="swv-modal"] button:not(.swv-button),
[class*="wallet-adapter-modal"] button:not([data-testid="wallet-adapter-button"]),
[class*="wallet-adapter-modal"] [role="button"]:not([data-testid="wallet-adapter-button"]) {
  background: transparent !important;
  background-color: transparent !important;
  background-image: none !important;
  color: inherit !important;
  border: none !important;
  box-shadow: none !important;
}

/* Ensure wallet modal items have proper hover states */
.swv-modal-list-item:hover,
[class*="wallet-adapter-modal"] [role="button"]:hover:not([data-testid="wallet-adapter-button"]) {
  background-color: rgba(255, 255, 255, 0.05) !important;
  background-image: none !important;
}